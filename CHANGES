$Id$
$Name$

Version 0.9.9 (200301XX)


Wonder of wonders... I'm actually using this again.  The guy who registered
flexbackup.org never picked up the files or updates his page so I'm
flipping pointers back to sourceforge.net I guess.

I'm mainly just using on-disk files now - will try to keep tape operation
tested.

Changes:
  - changed the index delete flags worked, it was too confusing overloading
      the -toc flag (WTF was I smoking 2 years ago?).
      Now toc only lists stuff, and db-fixing can be done with:
         flexbackup -rmindex all
         flexbackup -rmindex <key>
         flexbackup -rmindex <key> -f <file>
  - added "-rmfile <file>" option if we are backing up to disk.  nukes
      archive and its related index entry
  - take the seconds filed out of the archive + log names... it was just
      too long to interact with, and who really does more than 1 backup in a
      minute?
  - removed zip archive support.  They just don't like to work with
      stdout/stdin like other unix tools and are a pain to special case.
  - "-newtape" when using files will rm the files in the dir
  - support non $PATH or hardcoded locations to commands in config file:
         $path{'program'} = /path/to/program;

Bug Fixes:
  - doh - can't use find -cnewer & a reference file with touch -d together
      since the change time is still "now".  I remembered the suggestion but
      the long lapse in devel time made me forget to see if it worked.
      REMOVED cnewer mistake.
  - default config uses /var/lib rather than /var/state (FHS spec on this
      went away long ago)
  - don't pad blocks when archiving to files on disk
  - was using numeric sort when listing alphanumeric files
  - "-num" invalid when using files
  - newer cpio didn't like sparse in --create mode
  - errors in command chain weren't detected. now separate some of the
    steps; remote still hosed up


----------------------------------------------------------------------
Version 0.9.8.3 (20020824)

Revive the tree
Move support info/web site so this isn't stagnant anymore
Check in what I had pending

New Features:
 - works for block devices (like floppies).  Turns the indexing off since
      you can't do multiple files, but otherwise it works fine

Bug fixes:
 - use "&&" rather than ";" in between commands
 - use "-cnewer -or -newer" rather than "-newer"
 - set locale so touch works
 - tar - take off "! -type d" since we have --no recursion
 - log/backup files now use yyyymmddhhmm.ss times in the
   filenames. Previously you could get messed up if you ran two backups
      on the same day; files would clobber themselves
 - OpenBSD didn't have "mt rdhpos". Split the BSD flavors up.
 - add a rewind before erase when deleting old index
 - "-n" was touching the stamp file, now it won't



----------------------------------------------------------------------
Version 0.9.8 (19991102)

New Features:
 - add -newtape option to initialize index, but no backup
 - add -num <n> option for reads that will position the tape at the
      specified file number before reading
 - added config file option for whether "erase" actually calls "mt erase"
     or just rewinds - for some drives, mt erase takes hours...
     (variable is $erase_rewind_only)
 - tried to add intelligence for various mt flavors on different Unix variants
 - made block padding a config file option ($pad_blocks).  conv=sync was
     causing problems for Clemmit on OSF1.

Bug fixes:
 - sort the toc output correctly
 - rewind after printing toc
 - fix bug where tape indexes always started at 10 after awhile
     (similar sorting problem with setting $main::nextfile)

Cleanup:
 - web site moved
 - other minor cleanups to tape key handling
 - "-n" bypasses index operations as well
 - fix some messages/formatting

----------------------------------------------------------------------
Version 0.9.7 (19991019)

New Features:
 - table-of-contents support - tells you which backups are on which tapes.
     uses a simple "key" on the tape plus on-disk database files
 - added "traverse mountpoints" config option for non-dump types
     can skip nfs mounts or really do everything
 - added config option to turn off assumption that level zero "all"
     should erase the tape

Bug fixes:
 - add "conv=sync" to dd flags so it will pad blocks
     some tape drivers complain if writes are not padded
     "buffer" already did this since I used the B flag by default
 - don't use `date ..`, but POSIX::strftime() instead
     incremental backups on FreeBSD were busted (no date -r)
 - using $ in exclude expressions broke remote backups if the user's
     login shell was csh/tcsh due to it's insane syntax quirks.  Worked
     around it putting a trailing $ outside the second level quotes
 - works on OSF/1 boxes

Cleanup:
 - remove ftape table of contents now that I have a generic one
 - autodetect Linux ftape device, eliminates configuration
 - change time format slightly for consistency
 - cleaned up handling of reten/erase/rewind options
 - tape position display under FreeBSD is just "mt rdhpos",
   under others is "mt tell"
   ("mt status" cluttered things w/ lots of useless info)

----------------------------------------------------------------------
Version 0.9.6 (19991003)

New Features:
 - buffing is optional
 - log files for list/extract/compare (flexbackup.<operation>.log in cwd)
 - can now have more than one exclude expression defined
 - add -norewind flag
 - make symlink to latest log file
 - use our own timestamps for "dump", with -T
     config file variable to use /etc/dumpdates
 - flag in configuration file for mt variable block size
 - do buffering on archive read if enabled
 - add "-extract -files <file>" to extract a list of files from an archive
     (will need this later for interactive restore shell)
 - minimal Makefile that lets you set config path, bin path, etc. for install
 - can use "compress" now in addition to gzip/bzip2
 - added zip type
 - var in configuration file for afio compression cache size
 - flag in configuration file for tar atime preserve
 - flag in configuration file for tar record number printing
 - flag in configuration file for sparse file handling
 - add -compress flag to override config file setting

Bug fixes/cleanup:
 - afio nocompress types bug - have to list them all if we give the
     -E flag.. (I added mp3 and it ignored the builtin defaults)
     made generic \$nocompress_types since zip uses it too
 - find -regex doesn't exist on BSD, redo with egrep to be more
     generic
 - GPL clause in program itself not readme
 - redid remote commands to use only 1-way rsh/ssh
     archive command building done differently now as a result
 - redid command echo wrapping
 - dates back to string format (easier to read), use numeric only on BSD
     will work with pre-4.0 fileutils that have touch -t bug
 - tar exclude mess is fixed, using --files-from again as well.
    problem before was I was not stripping directory names
 - make better afio control file handling for volume labels
 - use -B (--read-full-blocks/--read-full-records) for tar
 - use $verbose to set restore -v for list/extract
 - log files and archives to disk use same filename pattern now
 - do obsolete timestamp removal at end of job not beginning
 - forgot to remove tar_verbose and cpio_verbose from conf file
 - debug shows real mt command
 - clean up flag handling some more, use long flags
 - sleep at end of backup not done if file or debug
 - if -noerase, move to eod before starting

----------------------------------------------------------------------
Version 0.9.5 (19990927)

New features:
 - buffering for all backup types
    now requires the "buffer" utility, everything piped through it
    if remote backup, buffers on both sides
 - every backup type now has an embedded "title" (level,date,host,etc)
     dump has had this info. by default
     for afio we make a tiny control script
     for tar we use -V for a volume label
     for cpio we touch a filename wih the info before backing up
 - config file regular expression for excluding files from backup
     doesn't work for dump, of course
 - config option for afio file size compression threshold
 - config option for afio nocompress file extension list
 - compression for all backup types
 - if reading from a file,  auto-set compression & archive type
     whee we can also list & extract rpm files :)

Bug fixes/cleanup:
 - nuke trailing slashes on given dirs
 - typo! mt defblksize, not mt defsetblk. also, that whole routine
     was just broken. fixed.
 - tar was archiving things twice. "find . | tar -c -T -" gives double
      result. revert back to non-find mode for tar, works fine
 - remote tar didn't quite work (needed full path for ssh/rsh)
 - remote broken if using filenames (and they were long)
 - error if remote host and this host are the same
 - error if device is dir and its relative
 - stderr output from new pipeline commands wasn't in  log file
 - fix dirs going on top of each other when  mult. dumps. + files
 - log file removal at end of job; undef logfile after compressing
 - compress, compr_level, verbose, buffer are generic options
 - commands are an array; command build cleanup; mt takes multiple commands


---------------------------------------------------------------
Version 0.9.4 (19990924)

New features:
 - bzip2 option for afio and tar archives, as well as log files
 - configurable compression level for afio
 - multiple tapes for an "all" level 0.  This just lets you split up
     backups onto different tapes, not end-of-media type of
     multivolume problems (that's on the todo list)
 - support for remote dump over ssh - use dd over an ssh pipe
 - support ssh for cpio remote backups - use dd over an ssh pipe
 - add -reten switch to retension before backup or any other operation
 - print "date of this level" sort of like dump does

Bug fixes/cleanup:
 - test if mt setblksize or mt defblksize is the right command to use
 - dump -a (autosize) works now. Found my problem was a known bug.
    >>> NOTE for Linux w/dump, you MUST install dump-0.4b4-10
       (redhat lorax) or newer, or equivalent patches if you want
       dump -a to work
 - afio doublebuffer only if local backup
 - dump length bug for "-fs all"
 - get last timestamp was off-by-one
 - output of archive commands didn't go to log file
 - with label "host:path-dir"; didn't work w/ remote + files
     labels are now "host-path-dir"
 - sanity checks in the setup, flag variables
 - check for programs in your path

---------------------------------------------------------------
Version 0.9.3 (for testing only)

New features:
 - can now archive to files instead of devices
     just set $device to a directory for backup
     compare/extract/list/restore can now take a filename argument
 - add -n option that doesn't run mt or the actual backup
 - timestamp changes:
     use "touch -t" not "touch -d" so FreeBSD works
     all dates now in YYYYMMDDhhmm.SS format
     use timestamps of the epoch for level 0 (simplifies code)
 - add "-d var=val" for overriding config values
 - tar mode uses "find" just like afio & cpio
 - afio doublebuffering option

Bug fixes/cleanup:
 - FreeBSD: if $dump_length set to 0 use dump -a
 - FreeBSD: fix for mt setblk
 - error if level > 0 and no level 0 stamp exists
 - fix label string for remote paths

---------------------------------------------------------------
Version 0.9.2 (19990920)

 - initial release to the public
 - gzip log files option
 - fix afio buffer to be in units of k in cfg file

Version 0.9.1 (1999019)

  - incrementals w/ afio cpio tar done (remote fs too!)
  - timestamp only after sucessful backup, but use the pre-backup time
  - noerase option

Version 0.8

  - redone with "use strict"
  - incremental for non-dump types almost done
  - automated pacakging
  - clean some duplicated code
  - rpm build, lsm file
  - previously just a local hack I had done for myself


Local Variables:
mode: flyspell
end:
